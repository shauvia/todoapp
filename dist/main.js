(()=>{"use strict";const e="",t="/users",n="/tasks";let s="";function a(c){let r=document.getElementById("taskList");for(let u=0;u<c.length;u++){let m=document.createElement("li"),g=document.createElement("input");g.setAttribute("type","checkbox");let y=document.createElement("label");y.innerHTML=c[u].taskName,console.log("displayTaskList, task name: ",c[u].taskName),g.checked=c[u].checked,console.log("displayTaskList, status z servera: ",c[u].checked);let p=c[u].taskId;console.log("displayTaskLis: taskId",p);let h=async a=>{console.log("changeStatus, address: ",e+t+s+n+p+g.checked),await l(e,t,n,p,g.checked,s)};g.addEventListener("click",h);let f=document.createElement("button");f.classList.add("btn-delete");let E=document.createElement("span");E.classList.add("mdi","mdi-delete","mdi-24px","delete_button");let k=document.createElement("span");k.classList.add("mdi","mdi-delete-empty","mdi-24px","delete_button_hovered");let T=async l=>{await o(e,t,n,p,s),d(),a(await i(e,t,n,s))};f.addEventListener("click",T),m.appendChild(g),m.appendChild(y),f.appendChild(E),f.appendChild(k),m.appendChild(f),r.appendChild(m)}}async function o(e,t,n,s,a){console.log("removeTask: url, tasks, taskId",e+t+n+s);let o=await fetch(e+t+n+"/"+s,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:JSON.stringify(a)}});if(!o.ok){throw new Error("fetch failed, removeTask, response.status: "+o.status," response.statusText: "+o.statusText)}}async function l(e,t,n,s,a,o){console.log("postStatusChange, status: ",a);const l={userInpStat:a};console.log("postStatusChange, address: ",e+t+n+s);let d=await fetch(e+t+n+"/"+s,{method:"POST",body:JSON.stringify(l),headers:{"Content-Type":"application/json",Authorization:JSON.stringify(o)}});if(!d.ok){throw new Error("fetch failed, postStatusChange, response.status: "+d.status," response.statusText: "+d.statusText)}let i=await d.text();return console.log("postStatusChange",i),i}function d(){let e=document.getElementById("taskList");for(;e.firstChild;)e.removeChild(e.firstChild)}async function i(e,t,n,s){console.log("getTasks",t,s,n);let a=await fetch(e+t+n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:JSON.stringify(s)}});if(!a.ok){throw new Error("fetch failed, getTasks, response.status: "+a.status," response.statusText: "+a.statusText)}let o=await a.json();return console.log("getTaskContent",o),o}async function c(e){m()}async function r(o){const l=document.getElementById("task").value;if(console.log("task",l),!l||""==l)return void(document.getElementById("errorMsg").innerHTML="Task is empty");const c={userTask:l};document.getElementById("task").value="",await async function(e,t,n,s,a){console.log("addTask",t,s,a);let o=await fetch(e+t+n,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json",Authorization:JSON.stringify(a)}});if(!o.ok)throw new Error("fetch failed, addTask, response.status: "+o.status," response.statusText: "+o.statusText);let l=await o.text();return console.log("addTaskContent",l),l}(e,t,n,c,s),console.log("1");let r=await i(e,t,n,s);console.log("listOfTasks",r),d(),a(r)}function u(){document.getElementById("displayMessage").innerHTML=""}function m(){document.getElementById("homePage").style.display="grid",document.getElementById("addTask").style.display="none"}async function g(e){"Enter"===e.key&&e.preventDefault()}async function y(n){let s=document.getElementById("createAccount").value,a=document.getElementById("loginPass").value;if(console.log("userName: ",s),!s||""==s)return u(),void(document.getElementById("displayMessage").innerHTML="Account username cannot be empty.");if(!a||""==a||a.length<5)return u(),void(document.getElementById("displayMessage").innerHTML="Password must have at least 5 letters.");let o=await async function(e,t,n,s){let a={login:n,password:s},o=await fetch(e+t,{method:"PUT",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}});if(!o.ok)throw new Error("fetch failed, createAcc failed, response.status: "+o.status," response.statusText: "+o.statusText);return await o.json()}(e,t,s,a);console.log("tripUrl, accUrl, userName: ",t,s),console.log("account: ",o),document.getElementById("createAccount").value="",document.getElementById("loginPass").value="",o.alreadyCreated?(u(),document.getElementById("displayMessage").innerHTML="You have already created account: "+s):(u(),m(),document.getElementById("displayMessage").innerHTML="Your account "+s+" has been set up.")}async function p(o){let l=document.getElementById("login").value,c=document.getElementById("pass").value;if(console.log("Login user acc: ",l),!l||""==l)return u(),void(document.getElementById("displayMessage").innerHTML="Login cannot be empty.");if(!c||""==c||c.length<5)return u(),void(document.getElementById("displayMessage").innerHTML="Password must have at least 5 letters ");let r=await async function(e,t,n,s){let a={login:n,password:s},o=await fetch(e+t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:JSON.stringify(a)}});if(!o.ok)throw new Error("fetch failed, logToAcc failed, response.status: "+o.status," response.statusText: "+o.statusText);return await o.json()}(e,t,l,c);console.log("login, account is created: ",r.isCreated),document.getElementById("login").value="",document.getElementById("pass").value="",r.isCreated?(s=r.token,console.log("logged to : ",s),u(),async function(){let o=await i(e,t,n,s);d(),a(o),document.getElementById("homePage").style.display="none",document.getElementById("addTask").style.display="grid"}()):(u(),document.getElementById("displayMessage").innerHTML="Account: "+l+" doesn't exist. Please create your account.")}function h(e){s="",m(),console.log("userLogin logout",s),u()}window.addEventListener("load",c),document.getElementById("createAccForm").addEventListener("keydown",g),document.getElementById("loginForm").addEventListener("keydown",g),document.getElementById("createAccBtn").addEventListener("click",y),document.getElementById("loginButton").addEventListener("click",p),document.getElementById("addTaskBtn").addEventListener("click",r),document.getElementById("logoutButton").addEventListener("click",h)})();
//# sourceMappingURL=main.js.map